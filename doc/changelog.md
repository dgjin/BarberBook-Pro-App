# 系统更新日志 (Changelog)

## v1.2.1 (2023-11-05)
### 优化
- **监控大屏实时性**: 大幅增强了监控页面的数据同步能力。现在通过 WebSocket 实时监听“新预约”和“签到”事件，并配合 10秒 自动轮询机制作为双重保障，确保在任何网络环境下大屏数据都能自动更新。
- **大屏通知交互**: 当有新客户预约或到店签到时，监控大屏右上角会自动弹出醒目的动态通知气泡，方便工作人员即时响应。

---

## v1.2.0 (2023-11-04)
### 修复与增强
- **个人信息同步修复**: 修复了客户修改个人信息（如头像、昵称）后无法持久保存到数据库的问题。现在所有修改都会实时同步至后端。
- **密码修改功能**: 在个人中心“编辑资料”弹窗中新增了密码修改入口，支持用户自助更新登录密码。新密码采用 SHA-256 加密存储，增强账户安全性。

---

## v1.1.9 (2023-11-03)
### 修复
- **取消预约功能**: 修复了“点击取消预约无反应”的问题。原因是在创建预约时未能正确获取数据库 ID，导致后续操作无法定位记录。现已修正数据库插入逻辑，确保预约记录完整。
- **个人中心状态同步**: 优化了个人中心数据展示逻辑，现在会优先显示服务器端的最新状态，确保取消操作后界面立即更新。
- **交互优化**: 移除了取消预约时的浏览器原生弹窗，改为直接执行，避免部分移动端浏览器拦截导致的交互失效。

---

## v1.1.8 (2023-11-02)
### 修复与优化
- **预约流程修复**: 解决了在游客模式下点击“登录后预约”按钮无响应的问题。移除了可能会被部分移动浏览器拦截的 `confirm` 弹窗，改为直接跳转至登录页。
- **自动违约处理**: 新增了后台调度器 (Scheduler)，系统现在会自动检查并取消超过预约时间 15 分钟仍未签到的过期预约，释放资源并规范预约秩序。

---

## v1.1.7 (2023-11-01)
### 新特性
- **游客模式 (Guest Mode)**: 在登录页新增“随便逛逛”入口，允许用户在不登录的情况下浏览理发师列表、查看店铺状态和监控大屏。
- **个人中心导航**: 登录用户的首页头像现在可以点击，直接跳转至个人中心（Check-in）页面。
- **权限控制**: 游客可以浏览预约界面查看时段，但在点击确认支付时会被拦截并提示登录。

---

## v1.1.6 (2023-10-31)
### 安全更新
- **密码加密存储**: 用户注册和登录流程现已集成 **SHA-256** 哈希算法。数据库不再存储明文密码，显著提升了账号安全性。
- **演示数据适配**: 更新了 Mock 数据库中的演示账号（手机号 `13888888888`），其密码 `123456` 现以哈希形式预存，确保在离线/演示模式下验证通过。

---

## v1.1.5 (2023-10-30)
### 修复
- **数据库连接**: 强制应用优先连接后端数据库。移除了对 API Key 格式的严格校验，防止因密钥格式差异导致系统意外回退到模拟模式 (Mock Mode)。现在仅当未配置任何凭证时才会启用模拟数据。

---

## v1.1.4 (2023-10-29)
### 核心修复
- **默认数据库自动链接**: 重构了 Supabase 客户端的 Mock 机制。当检测到未配置有效后端连接时，系统会自动加载内置的**全功能内存数据库**。
- **演示体验升级**: 现在的“演示模式”支持完整的业务流程，包括登录验证、预约写入、状态流转和排队计算，数据在单次会话内持久有效。

---

## v1.1.3 (2023-10-28)
### 优化
- **排队算法升级**: 首页“实时排队”现在仅统计**已到店签到 (Checked-in)** 的客户，排除了未到店的预约，计算更加精准。
- **日志查看器**: 登录页面新增版本日志查看入口，支持查看历史更新记录。

### 演示
- 支持在日志中热链接图片展示新功能预览：
![New Feature](https://placehold.co/600x200/007AFF/ffffff?text=Queue+System+Optimized)

---

## v1.1.2 (2023-10-27)
### 修复
- **注册功能**: 修复了注册按钮点击无反应的问题。优化了 Supabase 客户端初始化逻辑，当 API Key 无效时自动回退到模拟模式 (Mock Mode)，确保基本功能可用。同时优化了注册页面的表单交互和错误提示。
